@page "/characterPage"
@page "/characterPage/{Id:int}"

@if (Character is null)
{
    <div class="row justify-content-end">
        <a class="btn btn-secondary" href="">Back to Character Selection</a>
    </div>
    <div class="row justify-content-center text-center">
        <div class="row p-5">
            @if (Busy == false)
            {
                <p>No Character found.</p>
            }
            else
            {
                <div class="spinner-border p-5" role="status"></div>
            }
        </div>
    </div>
}
else
{
    <div class="row justify-content-end mb-1">
        <a class="btn btn-secondary" href="">Back to Character Selection</a>
    </div>
    <div class="row mb-3 shadow p-3 rounded">
        <div class="col-4">
            <h3 @onclick="ToggleCharacterNameInputDisplay" class="@CharacterNameHeaderCss">@Character.Name</h3>
            <input type="text" class="form-control @CharacterNameInputCss" @bind="Character.Name" @onfocusout="UpdateCharacterName" />
        </div>
        <div class="col-2">
            @*<p @onclick="ToggleTierDisplay" class="@TierHeaderCss">Tier @Character.Tier</p>*@
            <label for="tierInput">Tier</label>
            <select name="tierInput" class="form-control" @onchange="async (eventArgs) => await UpdateTier(eventArgs, Character)">
                <option>@Character.Tier</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
            </select>
        </div>
        <div class="col-2">
            <label for="xpInput">XP</label>
            @*<p class="@XPHeaderCss" @onclick="ToggleXPInput">@Character.XP XP</p>*@
            <input name="xpInput" type="number" class="form-control" value="@Character.XP" @onchange="async (eventArgs) => await UpdateXP(eventArgs)" />
        </div>
        <div class="col-2">
            <label for="wrathInput">Wrath</label>
            <input class="form-control" name="wrathInput" type="number" value="0" />
        </div>
        <div class="col-2">
            <label for="gloryInput">Glory</label>
            <input class="form-control" name="gloryInput" type="number" value="0" />
        </div>
    </div>
    <div class="row mb-3">
        <div class="col-md-3 col-xl-2 shadow p-3 rounded mx-2">
            <div class="mb-3">
                <AttributesComponent Attributes="Character.Attributes"
                                     ValueChanged="UpdateAttributeOrSkill"
                                     Character="Character" />
            </div>
            <div class="mb-3">
                <CombatTraitsComponent Character="Character" />
            </div>

            <div class="mb-3">
                <MentalTraitsComponent Character="Character" />
            </div>
        </div>
        <div class="col-md-6 col-xl-4 shadow p-3 rounded mx-2">
            <div class="mb-3">
                <SkillsComponent Skills="Character.Skills"
                                 ValueChanged="UpdateAttributeOrSkill"
                                 Character="Character" />
            </div>
        </div>
        <div class="col d-none d-xl-block mx-2">
            <div class="shadow p-3 rounded mb-3">
                <div class="row mb-2">
                    <div class="col">
                        <h4>Archetype</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @ArchetypeInfoCss" @onclick="ToggleArchetypeInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @ArchetypeInputCss" @onclick="ToggleArchetypeInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@ArchetypeInfoCss">
                    <ArchetypeInfoComponent Character="Character" />
                </div>
                <div class="@ArchetypeInputCss">
                    <ArchetypeFormComponent Character="Character" SubmitArchetype="UpdateArchetype" Archetypes="Archetypes" />
                </div>
            </div>
            <div class="mb-3 shadow rounded p-3">
                <div class="row">
                    <div class="col">
                        <h4>Armor</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @ArmorInfoCss" @onclick="ToggleArmorInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @ArmorInputCss" @onclick="ToggleArmorInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@ArmorInfoCss">
                    <ArmorInfoComponent Character="Character" />
                </div>
                <div class="@ArmorInputCss">
                    <ArmorFormComponent Character="Character" ArmorList="ArmorList" SubmitArmor="UpdateArmor" />
                </div>
            </div>
            <div class="mb-3 shadow p-3 rounded">
                <div class="row">
                    <div class="col">
                        <h4>Talents</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @TalentInfoCss" @onclick="ToggleTalentInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @TalentInputCss" @onclick="ToggleTalentInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@TalentInfoCss">
                    <TalentInfoComponent Character="Character" />
                </div>
                <div class="@TalentInputCss">
                    <TalentFormComponent Character="Character"
                                         UpdateTalents="UpdateTalents"
                                         AddNewTalent="async (talent) => await AddNewTalent(talent as Talent)"
                                         RemoveTalent="async (talent) => await RemoveTalentFromCharacter(talent as Talent)"
                                         Talents="TalentList"
                                         TalentSelected="async (talent) => await AddExistingTalentToCharacter(talent as Talent)" />
                </div>
            </div>
            <div class="shadow p-3 rounded mb-3">
                <div class="row">
                    <div class="col">
                        <h4>Weapons</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @WeaponInfoCss" @onclick="ToggleWeaponInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @WeaponInputCss" @onclick="ToggleWeaponInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@WeaponInfoCss">
                    <WeaponInfoComponent Character="Character" />
                </div>
                <div class="@WeaponInputCss">
                    <WeaponFormComponent Character="Character"
                                         UpdateWeapons="UpdateWeapons"
                                         AddNewWeapon="async (weapon) => await AddWeapon(weapon as Weapon)"
                                         RemoveWeapon="async (weapon) => await RemoveWeaponFromCharacter(weapon as Weapon)"
                                         Weapons="WeaponList"
                                         WeaponSelected="async (weapon) => await AddExistingWeaponToCharacter(weapon as Weapon)" />
                </div>
            </div>
        </div>
    </div>
    //Archetype and talents are displayed as a rows instead of in a single col on smaller screens.
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col">
                <h4>Weapons</h4>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @WeaponInfoCss" @onclick="ToggleWeaponInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @WeaponInputCss" @onclick="ToggleWeaponInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
        <div class="@WeaponInfoCss">
            <WeaponInfoComponent Character="Character" />
        </div>
        <div class="@WeaponInputCss">
            <WeaponFormComponent Character="Character"
                                 UpdateWeapons="UpdateWeapons"
                                 AddNewWeapon="async (weapon) => await AddWeapon(weapon as Weapon)"
                                 RemoveWeapon="async (weapon) => await RemoveWeaponFromCharacter(weapon as Weapon)"
                                 Weapons="WeaponList"
                                 WeaponSelected="async (weapon) => await AddExistingWeaponToCharacter(weapon as Weapon)" />
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col ml-3 mb-2">
                <h4>Archetype</h4>
                <div class="@ArchetypeInfoCss">
                    <ArchetypeInfoComponent Character="Character" />
                </div>
                <div class="@ArchetypeInputCss">
                    <ArchetypeFormComponent Character="Character" SubmitArchetype="UpdateArchetype" Archetypes="Archetypes" />
                </div>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @ArchetypeInfoCss" @onclick="ToggleArchetypeInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @ArchetypeInputCss" @onclick="ToggleArchetypeInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col ml-3 mb-2">
                <h4>Armor</h4>
                <div @onclick="ToggleArmorInputDisplay" class="@ArmorInfoCss">
                    <ArmorInfoComponent Character="Character" />
                </div>
                <div class="@ArmorInputCss">
                    <ArmorFormComponent Character="Character" ArmorList="ArmorList" SubmitArmor="UpdateArmor" />
                </div>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @ArmorInfoCss" @onclick="ToggleArmorInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @ArmorInputCss" @onclick="ToggleArmorInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col ml-3 mb-2">
                <h4>Talents</h4>
                <div class="@TalentInfoCss">
                    <TalentInfoComponent Character="Character" />
                </div>
                <div class="@TalentInputCss">
                    <TalentFormComponent Character="Character"
                                         UpdateTalents="UpdateTalents"
                                         AddNewTalent="async (talent) => await AddNewTalent(talent as Talent)"
                                         RemoveTalent="async (talent) => await RemoveTalentFromCharacter(talent as Talent)"
                                         Talents="TalentList"
                                         TalentSelected="async (talent) => await AddExistingTalentToCharacter(talent as Talent)" />
                </div>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @TalentInfoCss" @onclick="ToggleTalentInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @TalentInputCss" @onclick="ToggleTalentInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3">
        <div class="row">
            <div class="col">
                <h4>Gear</h4>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @GearInfoCss" @onclick="ToggleGearInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @GearInputCss" @onclick="ToggleGearInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
        <div class="@GearInfoCss">
            <GearInfoComponent Character="Character" />
        </div>
        <div class="@GearInputCss">
            <GearFormComponent Character="Character"
                               UpdateGearList="async () => await UpdateGearList()"
                               AddNewGear="async (gear) => await AddGear(gear as Gear)"
                               RemoveGear="async (gear) => await RemoveGearFromCharacter(gear as Gear)"
                               GearList="GearList"
                               GearSelected="async (gear) => await AddExistingGearToCharacter(gear as Gear)" />
        </div>
    </div>
}

