@page "/characterPage"
@page "/characterPage/{Id:int}"

@if (_vm.Character is null)
{
    <div class="row justify-content-end">
        <a class="btn btn-secondary" href="">Back to Character Selection</a>
    </div>
    <div class="row justify-content-center text-center">
        <div class="row p-5">
            @if (_vm.Busy == false)
            {
                <p>No Character found.</p>
            }
            else
            {
                <div class="spinner-border p-5" role="status"></div>
            }
        </div>
    </div>
}
else
{
    <div class="row justify-content-end mb-1">
        <a class="btn btn-secondary" href="">Back to Character Selection</a>
    </div>
    <div class="row mb-3 shadow p-3 rounded">
        <div class="col-4">
            <h3 @onclick="_vm.ToggleCharacterNameInputDisplay" class="@_vm.CharacterNameHeaderCss">@_vm.Character.Name</h3>
            <input type="text" class="form-control @_vm.CharacterNameInputCss" @bind="_vm.Character.Name" @onfocusout="_vm.UpdateCharacterName" />
        </div>
        <div class="col-2">
            @*<p @onclick="ToggleTierDisplay" class="@TierHeaderCss">Tier @Character.Tier</p>*@
            <label for="tierInput">Tier</label>
            <select name="tierInput" class="form-control" @onchange="async (eventArgs) => await _vm.UpdateTier(eventArgs, _vm.Character)">
                <option>@_vm.Character.Tier</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
            </select>
        </div>
        <div class="col-2">
            <label for="xpInput">XP</label>
            @*<p class="@XPHeaderCss" @onclick="ToggleXPInput">@Character.XP XP</p>*@
            <input name="xpInput" type="number" class="form-control" value="@_vm.Character.XP" @onchange="async (eventArgs) => await _vm.UpdateXP(eventArgs)" />
        </div>
        <div class="col-2">
            <label for="wrathInput">Wrath</label>
            <input class="form-control" name="wrathInput" type="number" value="0" />
        </div>
        <div class="col-2">
            <label for="gloryInput">Glory</label>
            <input class="form-control" name="gloryInput" type="number" value="0" />
        </div>
    </div>
    <div class="row mb-3">
        <div class="col-md-3 col-xl-2 shadow p-3 rounded mx-2">
            <div class="mb-3">
                <AttributesComponent Attributes="_vm.Character.Attributes"
                                     ValueChanged="_vm.UpdateAttributeOrSkill"
                                     Character="_vm.Character" />
            </div>
            <div class="mb-3">
                <CombatTraitsComponent Character="_vm.Character" />
            </div>

            <div class="mb-3">
                <MentalTraitsComponent Character="_vm.Character" />
            </div>
        </div>
        <div class="col-md-6 col-xl-4 shadow p-3 rounded mx-2">
            <div class="mb-3">
                <SkillsComponent Skills="_vm.Character.Skills"
                                 ValueChanged="_vm.UpdateAttributeOrSkill"
                                 Character="_vm.Character" />
            </div>
        </div>
        <div class="col d-none d-xl-block mx-2">
            <div class="shadow p-3 rounded mb-3">
                <div class="row mb-2">
                    <div class="col">
                        <h4>Archetype</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @_vm.ArchetypeInfoCss" @onclick="_vm.ToggleArchetypeInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @_vm.ArchetypeInputCss" @onclick="_vm.ToggleArchetypeInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@_vm.ArchetypeInfoCss">
                    <ArchetypeInfoComponent Character="_vm.Character" />
                </div>
                <div class="@_vm.ArchetypeInputCss">
                    <ArchetypeFormComponent Character="_vm.Character" SubmitArchetype="_vm.UpdateArchetype" Archetypes="_vm.Archetypes" />
                </div>
            </div>
            <div class="mb-3 shadow rounded p-3">
                <div class="row">
                    <div class="col">
                        <h4>Armor</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @_vm.ArmorInfoCss" @onclick="_vm.ToggleArmorInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @_vm.ArmorInputCss" @onclick="_vm.ToggleArmorInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@_vm.ArmorInfoCss">
                    <ArmorInfoComponent Character="_vm.Character" />
                </div>
                <div class="@_vm.ArmorInputCss">
                    <ArmorFormComponent Character="_vm.Character" ArmorList="_vm.ArmorList" SubmitArmor="_vm.UpdateArmor" />
                </div>
            </div>
            <div class="mb-3 shadow p-3 rounded">
                <div class="row">
                    <div class="col">
                        <h4>Talents</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @_vm.TalentInfoCss" @onclick="_vm.ToggleTalentInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @_vm.TalentInputCss" @onclick="_vm.ToggleTalentInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@_vm.TalentInfoCss">
                    <TalentInfoComponent Character="_vm.Character" />
                </div>
                <div class="@_vm.TalentInputCss">
                    <TalentFormComponent Character="_vm.Character"
                                         UpdateTalents="_vm.UpdateTalents"
                                         AddNewTalent="async (talent) => await _vm.AddNewTalent(talent as Talent)"
                                         RemoveTalent="async (talent) => await _vm.RemoveTalentFromCharacter(talent as Talent)"
                                         Talents="_vm.TalentList"
                                         TalentSelected="async (talent) => await _vm.AddExistingTalentToCharacter(talent as Talent)" />
                </div>
            </div>
            <div class="shadow p-3 rounded mb-3">
                <div class="row">
                    <div class="col">
                        <h4>Weapons</h4>
                    </div>
                    <div class="col">
                        <button class="btn btn-secondary btn-circle @_vm.WeaponInfoCss" @onclick="_vm.ToggleWeaponInputDisplay"><span class="oi oi-pencil"></span></button>
                        <button class="btn btn-secondary btn-circle @_vm.WeaponInputCss" @onclick="_vm.ToggleWeaponInputDisplay"><span class="oi oi-x"></span></button>
                    </div>
                </div>
                <div class="@_vm.WeaponInfoCss">
                    <WeaponInfoComponent Character="_vm.Character" />
                </div>
                <div class="@_vm.WeaponInputCss">
                    <WeaponFormComponent Character="_vm.Character"
                                         UpdateWeapons="_vm.UpdateWeapons"
                                         AddNewWeapon="async (weapon) => await _vm.AddWeapon(weapon as Weapon)"
                                         RemoveWeapon="async (weapon) => await _vm.RemoveWeaponFromCharacter(weapon as Weapon)"
                                         Weapons="_vm.WeaponList"
                                         WeaponSelected="async (weapon) => await _vm.AddExistingWeaponToCharacter(weapon as Weapon)" />
                </div>
            </div>
        </div>
    </div>
    //Archetype and talents are displayed as a rows instead of in a single col on smaller screens.
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col">
                <h4>Weapons</h4>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @_vm.WeaponInfoCss" @onclick="_vm.ToggleWeaponInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @_vm.WeaponInputCss" @onclick="_vm.ToggleWeaponInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
        <div class="@_vm.WeaponInfoCss">
            <WeaponInfoComponent Character="_vm.Character" />
        </div>
        <div class="@_vm.WeaponInputCss">
            <WeaponFormComponent Character="_vm.Character"
                                 UpdateWeapons="_vm.UpdateWeapons"
                                 AddNewWeapon="async (weapon) => await _vm.AddWeapon(weapon as Weapon)"
                                 RemoveWeapon="async (weapon) => await _vm.RemoveWeaponFromCharacter(weapon as Weapon)"
                                 Weapons="_vm.WeaponList"
                                 WeaponSelected="async (weapon) => await _vm.AddExistingWeaponToCharacter(weapon as Weapon)" />
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col ml-3 mb-2">
                <h4>Archetype</h4>
                <div class="@_vm.ArchetypeInfoCss">
                    <ArchetypeInfoComponent Character="_vm.Character" />
                </div>
                <div class="@_vm.ArchetypeInputCss">
                    <ArchetypeFormComponent Character="_vm.Character" SubmitArchetype="_vm.UpdateArchetype" Archetypes="_vm.Archetypes" />
                </div>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @_vm.ArchetypeInfoCss" @onclick="_vm.ToggleArchetypeInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @_vm.ArchetypeInputCss" @onclick="_vm.ToggleArchetypeInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col ml-3 mb-2">
                <h4>Armor</h4>
                <div @onclick="_vm.ToggleArmorInputDisplay" class="@_vm.ArmorInfoCss">
                    <ArmorInfoComponent Character="_vm.Character" />
                </div>
                <div class="@_vm.ArmorInputCss">
                    <ArmorFormComponent Character="_vm.Character" ArmorList="_vm.ArmorList" SubmitArmor="_vm.UpdateArmor" />
                </div>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @_vm.ArmorInfoCss" @onclick="_vm.ToggleArmorInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @_vm.ArmorInputCss" @onclick="_vm.ToggleArmorInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3 d-xl-none">
        <div class="row">
            <div class="col ml-3 mb-2">
                <h4>Talents</h4>
                <div class="@_vm.TalentInfoCss">
                    <TalentInfoComponent Character="_vm.Character" />
                </div>
                <div class="@_vm.TalentInputCss">
                    <TalentFormComponent Character="_vm.Character"
                                         UpdateTalents="_vm.UpdateTalents"
                                         AddNewTalent="async (talent) => await _vm.AddNewTalent(talent as Talent)"
                                         RemoveTalent="async (talent) => await _vm.RemoveTalentFromCharacter(talent as Talent)"
                                         Talents="_vm.TalentList"
                                         TalentSelected="async (talent) => await _vm.AddExistingTalentToCharacter(talent as Talent)" />
                </div>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @_vm.TalentInfoCss" @onclick="_vm.ToggleTalentInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @_vm.TalentInputCss" @onclick="_vm.ToggleTalentInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
    </div>
    <div class="shadow p-3 rounded mb-3">
        <div class="row">
            <div class="col">
                <h4>Gear</h4>
            </div>
            <div class="col">
                <button class="btn btn-secondary btn-circle @_vm.GearInfoCss" @onclick="_vm.ToggleGearInputDisplay"><span class="oi oi-pencil"></span></button>
                <button class="btn btn-secondary btn-circle @_vm.GearInputCss" @onclick="_vm.ToggleGearInputDisplay"><span class="oi oi-x"></span></button>
            </div>
        </div>
        <div class="@_vm.GearInfoCss">
            <GearInfoComponent Character="_vm.Character" />
        </div>
        <div class="@_vm.GearInputCss">
            <GearFormComponent Character="_vm.Character"
                               UpdateGearList="async () => await _vm.UpdateGearList()"
                               AddNewGear="async (gear) => await _vm.AddGear(gear as Gear)"
                               RemoveGear="async (gear) => await _vm.RemoveGearFromCharacter(gear as Gear)"
                               GearList="_vm.GearList"
                               GearSelected="async (gear) => await _vm.AddExistingGearToCharacter(gear as Gear)" />
        </div>
    </div>
}

